# Cinema EPG Collector

ะกะฑะพััะธะบ EPG ะดะฐะฝะฝัั ะดะปั IPTV ั ัะธะปัััะฐัะธะตะน ัะธะปัะผะพะฒ, ะพะฑะพะณะฐัะตะฝะธะตะผ ัะตัะตะท TMDB API ะธ ะปะพะบะฐะปัะฝะพะน ะดะพััะฐะฒะบะพะน ะฟะพััะตัะพะฒ.

## ๐ฏ ะะพะทะผะพะถะฝะพััะธ

- ะกะบะฐัะธะฒะฐะฝะธะต EPG ะธะท IPTV API
- ะคะธะปัััะฐัะธั ัะธะปัะผะพะฒ ะฟะพ ะบะฐัะตะณะพัะธะธ "ะฅ/ั"
- ะะฑะพะณะฐัะตะฝะธะต ะดะฐะฝะฝัั ัะตัะตะท TMDB API
- ะะพะบะฐะปัะฝะฐั ะดะพััะฐะฒะบะฐ ะฟะพััะตัะพะฒ (ะธะทะฑะตะณะฐั ะฑะปะพะบะธัะพะฒะบะธ CDN)
- REST API ะดะปั ะดะพัััะฟะฐ ะบ ะดะฐะฝะฝัะผ
- ะกะพะฒัะตะผะตะฝะฝัะน ะฒะตะฑ-ะธะฝัะตััะตะนั
- Docker-ะบะพะฝัะตะนะฝะตัะธะทะฐัะธั
- ะกัััะบัััะธัะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต
- ะะพะฒัะพัะฝัะต ะฟะพะฟััะบะธ HTTP-ะทะฐะฟัะพัะพะฒ ั ัะบัะฟะพะฝะตะฝัะธะฐะปัะฝะพะน ะทะฐะดะตัะถะบะพะน
- HTTP-ะบััะธัะพะฒะฐะฝะธะต ะธ ะบััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ TMDB

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
โ   IPTV API      โโโโโถโ  Backend (FastAPI) โโโโโถโ  Frontend (React)โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
                              โ                         โ
                              โผ                         โผ
                       โโโโโโโโโโโโโโโ         โโโโโโโโโโโโโโโโโโโ
                       โ  TMDB API   โ         โ   Web Browser   โ
                       โโโโโโโโโโโโโโโ         โโโโโโโโโโโโโโโโโโโ
```

## ๐ ะัััััะน ััะฐัั

### Docker (ัะตะบะพะผะตะฝะดัะตััั)

```bash
# ะะปะพะฝะธัะพะฒะฐัั ัะตะฟะพะทะธัะพัะธะน
git clone https://github.com/yhtyyar/cinema-epg-collector.git
cd cinema-epg-collector

# ะกะบะพะฟะธัะพะฒะฐัั ะธ ะฝะฐัััะพะธัั .env
cp .env.example .env
# ะััะตะดะฐะบัะธัะพะฒะฐัั .env, ะดะพะฑะฐะฒะธะฒ TMDB_API_KEY

# ะะฐะฟัััะธัั ะฒัะต ัะตัะฒะธัั
docker-compose up --build -d

# API ะฑัะดะตั ะดะพัััะฟะตะฝ ะฟะพ ะฐะดัะตัั: http://localhost:8000
# ะะตะฑ-ะธะฝัะตััะตะนั ะฑัะดะตั ะดะพัััะฟะตะฝ ะฟะพ ะฐะดัะตัั: http://localhost:3000
```

### ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ

```bash
# ะะปะพะฝะธัะพะฒะฐัั ัะตะฟะพะทะธัะพัะธะน
git clone https://github.com/yhtyyar/cinema-epg-collector.git
cd cinema-epg-collector

# ะกะพะทะดะฐัั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
python -m venv venv
source venv/bin/activate  # Linux/Mac
# ะธะปะธ
venv\Scripts\activate     # Windows

# ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ
pip install -r requirements.txt

# ะกะบะพะฟะธัะพะฒะฐัั ะธ ะฝะฐัััะพะธัั .env
cp .env.example .env
# ะััะตะดะฐะบัะธัะพะฒะฐัั .env, ะดะพะฑะฐะฒะธะฒ TMDB_API_KEY

# ะะฐะฟัััะธัั API ัะตัะฒะตั
python start_api.py --host 0.0.0.0 --port 8000
# ะธะปะธ ะธัะฟะพะปัะทะพะฒะฐัั uvicorn ะฝะฐะฟััะผัั:
# uvicorn epg_collector.api.app:app --host 0.0.0.0 --port 8000

# ะ ะดััะณะพะน ะบะพะฝัะพะปะธ ะทะฐะฟัััะธัั ััะพะฝัะตะฝะด
cd frontend
npm install
npm run dev
```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
.
โโโ epg_collector/          # ะัะบะตะฝะด ะฟัะธะปะพะถะตะฝะธะต
โ   โโโ api/                # FastAPI REST API
โ   โโโ cli.py              # CLI ะธะฝัะตััะตะนั
โ   โโโ config.py           # ะะพะฝัะธะณััะฐัะธั
โ   โโโ http_client.py      # HTTP ะบะปะธะตะฝั ั ะฟะพะฒัะพัะฝัะผะธ ะฟะพะฟััะบะฐะผะธ
โ   โโโ iptv_api.py         # ะะฐะณััะทัะธะบ EPG
โ   โโโ filters.py          # ะคะธะปัััั ะดะฐะฝะฝัั
โ   โโโ tmdb.py             # ะะฝัะตะณัะฐัะธั ั TMDB
โ   โโโ posters.py          # ะะฐะณััะทัะธะบ ะฟะพััะตัะพะฒ
โ   โโโ logging_config.py   # ะะฐัััะพะนะบะฐ ะปะพะณะธัะพะฒะฐะฝะธั
โโโ frontend/               # ะคัะพะฝัะตะฝะด ะฟัะธะปะพะถะตะฝะธะต (React/Vite)
โโโ data/                   # ะะฐะฝะฝัะต (EPG, ัะธะปัะผั, ะฟะพััะตัั)
โโโ cache/                  # ะัั HTTP ะธ TMDB
โโโ logs/                   # ะะพะณะธ ะฟัะธะปะพะถะตะฝะธั
โโโ docker-compose.yml      # Docker Compose ะบะพะฝัะธะณััะฐัะธั
โโโ Dockerfile              # Dockerfile ะดะปั ะฑัะบะตะฝะดะฐ
โโโ requirements.txt        # ะะฐะฒะธัะธะผะพััะธ Python
```

## โ๏ธ ะะพะฝัะธะณััะฐัะธั

ะัะต ะฝะฐัััะพะนะบะธ ะทะฐะดะฐัััั ัะตัะตะท ัะฐะนะป [.env](file:///C:/Users/User/CascadeProjects/cinema-epg-collector/.env) ะธะปะธ ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั:

```env
# IPTV API
IPTV_BASE_URL=https://pl.iptv2021.com/api/v4/epg
IPTV_PARAMS_ID=17305
IPTV_HEADER_X_TOKEN=your_token_here

# TMDB API (ะพะฑัะทะฐัะตะปัะฝะพ)
TMDB_API_KEY=your_tmdb_api_key_here

# API ะฝะฐัััะพะนะบะธ
API_HOST=0.0.0.0
API_PORT=8000

# Pipeline ะฝะฐัััะพะนะบะธ
AUTO_RUN_PIPELINE=false
SKIP_ENRICHMENT_IF_EXISTS=true
```

### ะัะฝะพะฒะฝัะต ะฟะฐัะฐะผะตััั

- `TMDB_API_KEY` - API ะบะปัั ะดะปั ะดะพัััะฟะฐ ะบ TMDB (ะพะฑัะทะฐัะตะปัะฝะพ)
- `API_HOST` - ะฅะพัั ะดะปั API ัะตัะฒะตัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั 0.0.0.0)
- `API_PORT` - ะะพัั ะดะปั API ัะตัะฒะตัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั 8000)
- `AUTO_RUN_PIPELINE` - ะะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ ะฟะฐะนะฟะปะฐะนะฝะฐ ะฟัะธ ััะฐััะต API
- `SKIP_ENRICHMENT_IF_EXISTS` - ะัะพะฟัััะธัั ะพะฑะพะณะฐัะตะฝะธะต ะตัะปะธ ะดะฐะฝะฝัะต ัะถะต ัััะตััะฒััั

## ๐๏ธ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### CLI ะบะพะผะฐะฝะดั

```bash
# ะะบัะธะฒะธัะพะฒะฐัั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
source venv/bin/activate

# ะะฐะณััะทะธัั EPG ะดะฐะฝะฝัะต
python -m epg_collector.cli fetch-epg

# ะััะธะปัััะพะฒะฐัั ัะธะปัะผั
python -m epg_collector.cli filter-movies

# ะะฑะพะณะฐัะธัั ะดะฐะฝะฝัะต ัะตัะตะท TMDB
python -m epg_collector.cli enrich

# ะัะฟะพะปะฝะธัั ะฟะพะปะฝัะน ัะธะบะป
python -m epg_collector.cli run-all
```

### API ัะฝะดะฟะพะธะฝัั

- `GET /healthz` - ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั
- `GET /api/movies` - ะกะฟะธัะพะบ ัะธะปัะผะพะฒ ั ัะธะปัััะฐัะธะตะน ะธ ะฟะฐะณะธะฝะฐัะธะตะน
- `GET /api/movies/{id}` - ะะพะปััะธัั ัะธะปัะผ ะฟะพ ID
- `GET /api/movies/search` - ะะพะธัะบ ัะธะปัะผะพะฒ
- `POST /api/collect-data` - ะะฐะฟัััะธัั ัะฑะพั ะดะฐะฝะฝัั ะฒ ัะพะฝะต
- `GET /api/data-status` - ะะพะปััะธัั ััะฐััั ะดะฐะฝะฝัั
- `GET /static/posters/{filename}` - ะะพััะฐะฒะบะฐ ะฟะพััะตัะพะฒ

### ะะฐะฟััะบ API ั ะฝะฐัััะฐะธะฒะฐะตะผัะผ ัะพััะพะผ ะธ ะฟะพััะพะผ

```bash
# ะะฐะฟัััะธัั API ั ะบะฐััะพะผะฝัะผะธ ะฟะฐัะฐะผะตััะฐะผะธ
python start_api.py --host 194.35.48.118 --port 8080
```

## ๐ ะะตะฑ-ะธะฝัะตััะตะนั

ะคัะพะฝัะตะฝะด ะดะพัััะฟะตะฝ ะฟะพ ะฐะดัะตัั [http://localhost:3000](http://localhost:3000) ะฟะพัะปะต ะทะฐะฟััะบะฐ.

## ๐ณ Docker

### ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ

```bash
# ะกะพะฑัะฐัั ะธ ะทะฐะฟัััะธัั ะฒัะต ัะตัะฒะธัั
docker-compose up --build -d

# ะััะฐะฝะพะฒะธัั ัะตัะฒะธัั
docker-compose down
```

### ะะพะฝัะธะณััะฐัะธั Docker

ะัะต ะฝะฐัััะพะนะบะธ ะฟะตัะตะดะฐัััั ัะตัะตะท ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะฒ `docker-compose.yml`.

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะะพะณะธ

ะะพะณะธ ะดะพัััะฟะฝั ะฒ ะดะธัะตะบัะพัะธะธ `logs/` ะธะปะธ ัะตัะตะท `docker-compose logs`.

### Health Checks

- API: `GET /healthz`
- ะะฐะฝะฝัะต: `GET /api/data-status`

## ๐ง ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะัะพะฑะปะตะผั ั TMDB

ะฃะฑะตะดะธัะตัั, ััะพ `TMDB_API_KEY` ัััะฐะฝะพะฒะปะตะฝ ะฟัะฐะฒะธะปัะฝะพ ะฒ [.env](file:///C:/Users/User/CascadeProjects/cinema-epg-collector/.env).

### ะัะพะฑะปะตะผั ั IPTV API

ะัะพะฒะตัััะต ะฟัะฐะฒะธะปัะฝะพััั `IPTV_HEADER_X_TOKEN` ะฒ [.env](file:///C:/Users/User/CascadeProjects/cinema-epg-collector/.env).

### ะัะพะฑะปะตะผั ั ะฟะพััะตัะฐะผะธ

ะัะพะฒะตัััะต, ััะพ ะดะธัะตะบัะพัะธั `data/posters` ัััะตััะฒัะตั ะธ ะดะพัััะฟะฝะฐ ะดะปั ะทะฐะฟะธัะธ.

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

- HTTP-ะบััะธัะพะฒะฐะฝะธะต ะดะปั ัะผะตะฝััะตะฝะธั ะฝะฐะณััะทะบะธ ะฝะฐ ะฒะฝะตัะฝะธะต API
- ะะพะฒัะพัะฝัะต ะฟะพะฟััะบะธ ั ัะบัะฟะพะฝะตะฝัะธะฐะปัะฝะพะน ะทะฐะดะตัะถะบะพะน ะดะปั ะฝะฐะดะตะถะฝะพััะธ
- ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะพะฝะพะฒัั ะทะฐะดะฐั
- ะญััะตะบัะธะฒะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฟะฐะผััะธ

## ๐ ะะพะบัะผะตะฝัะฐัะธั API

ะะพัะปะต ะทะฐะฟััะบะฐ API ะดะพะบัะผะตะฝัะฐัะธั ะดะพัััะฟะฝะฐ ะฟะพ ะฐะดัะตัั [http://localhost:8000/docs](http://localhost:8000/docs).

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

1. ะคะพัะบะฝะธัะต ัะตะฟะพะทะธัะพัะธะน
2. ะกะพะทะดะฐะนัะต ะฒะตัะบั ะดะปั ะฒะฐัะตะน ััะฝะบัะธะธ (`git checkout -b feature/AmazingFeature`)
3. ะะฐัะธะบัะธััะนัะต ะธะทะผะตะฝะตะฝะธั (`git commit -m 'Add some AmazingFeature'`)
4. ะะฐะฟััััะต ะฒะตัะบั (`git push origin feature/AmazingFeature`)
5. ะัะบัะพะนัะต Pull Request

## ๐ ะะธัะตะฝะทะธั

ะญัะพั ะฟัะพะตะบั ะปะธัะตะฝะทะธัะพะฒะฐะฝ ะฟะพ ะปะธัะตะฝะทะธะธ MIT - ัะผ. ัะฐะนะป [LICENSE](file:///C:/Users/User/CascadeProjects/cinema-epg-collector/LICENSE) ะดะปั ะฟะพะดัะพะฑะฝะพััะตะน.

## ๐ ะะปะฐะณะพะดะฐัะฝะพััะธ

- [TMDB](https://www.themoviedb.org/) ะทะฐ API
- [FastAPI](https://fastapi.tiangolo.com/) ะทะฐ ััะตะนะผะฒะพัะบ
- [React](https://reactjs.org/) ะทะฐ ััะพะฝัะตะฝะด ะฑะธะฑะปะธะพัะตะบั
```

parameter>